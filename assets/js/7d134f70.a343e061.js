"use strict";(self.webpackChunktailcall_run=self.webpackChunktailcall_run||[]).push([[3714],{3905:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>c});var n=a(7294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var l=n.createContext({}),p=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},u=function(e){var t=p(e.components);return n.createElement(l.Provider,{value:t},e.children)},d="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),d=p(a),m=i,c=d["".concat(l,".").concat(m)]||d[m]||h[m]||r;return a?n.createElement(c,s(s({ref:t},u),{},{components:a})):n.createElement(c,s({ref:t},u))}));function c(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=a.length,s=new Array(r);s[0]=m;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o[d]="string"==typeof e?e:i,s[1]=o;for(var p=2;p<r;p++)s[p]=a[p];return n.createElement.apply(null,s)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},890:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>p});var n=a(7462),i=(a(7294),a(3905));const r={title:"Operators",sidebar_position:1},s=void 0,o={unversionedId:"guides/operators",id:"guides/operators",title:"Operators",description:"Tailcall DSL builds on your existing GraphQL knowledge by allowing the addition of some custom operators. These operators provide powerful compile time guarantees to make sure your API composition is tight and robust. The operator information is used to automatically generates highly optimized resolver logic for your types.",source:"@site/docs/guides/operators.md",sourceDirName:"guides",slug:"/guides/operators",permalink:"/docs/guides/operators",draft:!1,editUrl:"https://github.com/tailcallhq/tailcallhq.github.io/tree/develop/docs/guides/operators.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{title:"Operators",sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Execute",permalink:"/docs/getting_started/execute"},next:{title:"Operator Composition",permalink:"/docs/guides/composition"}},l={},p=[{value:"@server",id:"server",level:2},{value:"workers",id:"workers",level:3},{value:"port",id:"port",level:3},{value:"enableCacheControlHeader",id:"enablecachecontrolheader",level:3},{value:"enableGraphiql",id:"enablegraphiql",level:3},{value:"vars",id:"vars",level:3},{value:"enableIntrospection",id:"enableintrospection",level:3},{value:"enableQueryValidation",id:"enablequeryvalidation",level:3},{value:"enableResponseValidation",id:"enableresponsevalidation",level:3},{value:"globalResponseTimeout",id:"globalresponsetimeout",level:3},{value:"@upstream",id:"upstream",level:2},{value:"poolIdleTimeout",id:"poolidletimeout",level:3},{value:"poolMaxIdlePerHost",id:"poolmaxidleperhost",level:3},{value:"keepAliveInterval",id:"keepaliveinterval",level:3},{value:"keepAliveTimeout",id:"keepalivetimeout",level:3},{value:"keepAliveWhileIdle",id:"keepalivewhileidle",level:3},{value:"proxy",id:"proxy",level:3},{value:"connectTimeout",id:"connecttimeout",level:3},{value:"timeout",id:"timeout",level:3},{value:"tcpKeepAlive",id:"tcpkeepalive",level:3},{value:"userAgent",id:"useragent",level:3},{value:"allowedHeaders",id:"allowedheaders",level:3},{value:"baseURL",id:"baseurl",level:3},{value:"enableHttpCache",id:"enablehttpcache",level:3},{value:"enableBatchRequests",id:"enablebatchrequests",level:3},{value:"Trade-offs",id:"trade-offs",level:4},{value:"Tips",id:"tips",level:4},{value:"batch",id:"batch",level:3},{value:"@http",id:"http",level:2},{value:"baseURL",id:"baseurl-1",level:3},{value:"path",id:"path",level:3},{value:"method",id:"method",level:3},{value:"query",id:"query",level:3},{value:"body",id:"body",level:3},{value:"headers",id:"headers",level:3},{value:"groupBy",id:"groupby",level:3},{value:"@modify",id:"modify",level:2},{value:"name",id:"name",level:3},{value:"omit",id:"omit",level:3},{value:"@addField",id:"addfield",level:2},{value:"@const",id:"const",level:2}],u={toc:p},d="wrapper";function h(e){let{components:t,...a}=e;return(0,i.kt)(d,(0,n.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Tailcall DSL builds on your existing GraphQL knowledge by allowing the addition of some custom operators. These operators provide powerful compile time guarantees to make sure your API composition is tight and robust. The operator information is used to automatically generates highly optimized resolver logic for your types."),(0,i.kt)("h2",{id:"server"},"@server"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"@server")," directive, when applied at the schema level, offers a comprehensive set of server configurations. It dictates how the server behaves and helps tune tailcall for various use-cases."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},"schema @server(...[ServerSettings]...){\n    query: Query\n    mutation: Mutation\n}\n")),(0,i.kt)("p",null,"In this templated structure, replace ",(0,i.kt)("inlineCode",{parentName:"p"},"...[ServerSettings]...")," with specific configurations tailored to your project's needs. Adjust and expand these settings as necessary."),(0,i.kt)("p",null,"The various ",(0,i.kt)("inlineCode",{parentName:"p"},"ServerSettings")," options and their details are explained below."),(0,i.kt)("h3",{id:"workers"},"workers"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"workers")," sets the number of worker threads the server will use. If not specified, the default value is the number of cores available to the system."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},"schema @server(workers: 32) {\n  query: Query\n  mutation: Mutation\n}\n")),(0,i.kt)("p",null,"In this example, the ",(0,i.kt)("inlineCode",{parentName:"p"},"workers")," is set to ",(0,i.kt)("inlineCode",{parentName:"p"},"32"),". This means that the Tailcall server will use 32 worker threads."),(0,i.kt)("h3",{id:"port"},"port"),(0,i.kt)("p",null,"This refers to the ",(0,i.kt)("inlineCode",{parentName:"p"},"port")," on which the Tailcall will be running. If not specified, the default port is ",(0,i.kt)("inlineCode",{parentName:"p"},"8000"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},"schema @server(port: 8090) {\n  query: Query\n  mutation: Mutation\n}\n")),(0,i.kt)("p",null,"In this example, the ",(0,i.kt)("inlineCode",{parentName:"p"},"port")," is set to ",(0,i.kt)("inlineCode",{parentName:"p"},"8090"),". This means that the Tailcall will be accessible at ",(0,i.kt)("inlineCode",{parentName:"p"},"http://localhost:8090"),"."),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"Always lean towards non-standard ports, steering clear of typical ones like 80 or 8080. Ensure your chosen port is unoccupied.")),(0,i.kt)("h3",{id:"enablecachecontrolheader"},"enableCacheControlHeader"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"enableCacheControlHeader")," configuration, when activated, instructs Tailcall to transmit ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control"},"Cache-Control")," headers in its responses. The ",(0,i.kt)("inlineCode",{parentName:"p"},"max-age")," value in the header, is the least of the values in the responses received by tailcall from the upstream services. By default, this is set to ",(0,i.kt)("inlineCode",{parentName:"p"},"false")," meaning no header is set."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},"schema @server(enableCacheControlHeader: true) {\n  query: Query\n  mutation: Mutation\n}\n")),(0,i.kt)("h3",{id:"enablegraphiql"},"enableGraphiql"),(0,i.kt)("p",null,"This configuration dictates the path on which the GraphiQL interface is hosted within Tailcall. ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/graphql/graphiql"},"GraphiQL")," is a built-in, interactive in-browser GraphQL IDE that simplifies query development and testing. By designating a path, such as ",(0,i.kt)("inlineCode",{parentName:"p"},"/graphiql"),", you grant access to this IDE at that specific URL endpoint, like ",(0,i.kt)("inlineCode",{parentName:"p"},"http://localhost:8000/graphiql"),". If not provided, GraphiQL won't be available. It's a ready-to-use feature in Tailcall, requiring no additional setup."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},'schema @server(port: 8000, enableGraphiql: "/graphiql") {\n  query: Query\n  mutation: Mutation\n}\n')),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"While the GraphiQL interface is a powerful tool for development, it's recommended to disable it in production environments, especially if you're not exposing GraphQL APIs directly to users. This ensures an added layer of security and reduces unnecessary exposure.")),(0,i.kt)("h3",{id:"vars"},"vars"),(0,i.kt)("p",null,"This configuration allows you to define local variables that can be leveraged during the server's operations. These variables are particularly handy when you need to store constant configurations, secrets, or other shared information that various operations might require."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},'schema @server(vars: {key: "apiKey", value: "YOUR_API_KEY_HERE"}) {\n  query: Query\n  mutation: Mutation\n}\n\ntype Query {\n  externalData: Data\n    @http(path: "/external-api/data", headers: [{key: "Authorization", value: "Bearer {{vars.apiKey}}"}])\n}\n')),(0,i.kt)("p",null,"In the provided example, a variable named ",(0,i.kt)("inlineCode",{parentName:"p"},"apiKey"),' is set with a placeholder value of "YOUR_API_KEY_HERE". This configuration implies that whenever Tailcall fetches data from the ',(0,i.kt)("inlineCode",{parentName:"p"},"externalData")," endpoint, it includes the ",(0,i.kt)("inlineCode",{parentName:"p"},"apiKey")," in the Authorization header of the HTTP request."),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"Local variables, like ",(0,i.kt)("inlineCode",{parentName:"p"},"apiKey"),", can be instrumental in securing access to external services or providing a unified place for configurations. Ensure that sensitive information stored this way is well protected and not exposed unintentionally, especially if your Tailcall configuration is publicly accessible.")),(0,i.kt)("h3",{id:"enableintrospection"},"enableIntrospection"),(0,i.kt)("p",null,"This setting governs whether introspection queries are permitted on the server. Introspection is an intrinsic feature of GraphQL, allowing clients to fetch information about the schema directly. This can be instrumental for tools and client applications to understand the types, fields, and operations available. By default, this setting is enabled (",(0,i.kt)("inlineCode",{parentName:"p"},"true"),")."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},"schema @server(enableIntrospection: false) {\n  query: Query\n  mutation: Mutation\n}\n")),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"Although introspection is beneficial during development and debugging stages, it's wise to consider disabling it in production environments. Turning off introspection in live deployments can enhance security by preventing potential attackers from easily discerning the schema and any associated business logic or data structures.")),(0,i.kt)("h3",{id:"enablequeryvalidation"},"enableQueryValidation"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"enableQueryValidation")," configuration specifies whether the server should validate incoming GraphQL queries against the defined schema. Validating each query ensures its conformity to the schema, preventing errors from invalid or malformed queries. However, there are situations where you might opt to disable it, notably when seeking to ",(0,i.kt)("strong",{parentName:"p"},"enhance server performance")," at the cost of such checks. This defaults to ",(0,i.kt)("inlineCode",{parentName:"p"},"true")," if not specified."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},"schema @server(enableQueryValidation: false) {\n  query: Query\n  mutation: Mutation\n}\n")),(0,i.kt)("p",null,"In the example above, ",(0,i.kt)("inlineCode",{parentName:"p"},"enableQueryValidation")," is set to ",(0,i.kt)("inlineCode",{parentName:"p"},"false"),", bypassing the validation phase for incoming queries."),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"This should be enabled in dev environment to make sure the queries sent are correct and validated, however in production env, you could consider disabling it for improved performance.")),(0,i.kt)("h3",{id:"enableresponsevalidation"},"enableResponseValidation"),(0,i.kt)("p",null,"Tailcall automatically can infer the schema of the http endpoints for you. This information can be used to validate responses that are received from the upstream services. Enabling this setting allows you to perform exactly that. If this is not specified, the default setting for ",(0,i.kt)("inlineCode",{parentName:"p"},"enableResponseValidation")," is ",(0,i.kt)("inlineCode",{parentName:"p"},"false"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},"schema @server(enableResponseValidation: true) {\n  query: Query\n  mutation: Mutation\n}\n")),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"Disabling this setting will offer major performance improvements, but at the potential expense of data.")),(0,i.kt)("h3",{id:"globalresponsetimeout"},"globalResponseTimeout"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"globalResponseTimeout")," configuration determines the maximum duration a query is allowed to run before it's terminated by the server. Essentially, it acts as a safeguard against long-running queries that could strain resources or pose security concerns."),(0,i.kt)("p",null,"If not explicitly defined, there might be a system-specific or default value that applies."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},"schema @server(globalResponseTimeout: 5000) {\n  query: Query\n  mutation: Mutation\n}\n")),(0,i.kt)("p",null,"In this given example, the ",(0,i.kt)("inlineCode",{parentName:"p"},"globalResponseTimeout")," is set to ",(0,i.kt)("inlineCode",{parentName:"p"},"5000")," milliseconds, or 5 seconds. This means any query execution taking longer than this duration will be automatically terminated by the server."),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"It's crucial to set an appropriate response timeout, especially in production environments. This not only optimizes resource utilization but also acts as a security measure against potential denial-of-service attacks where adversaries might run complex queries to exhaust server resources.")),(0,i.kt)("h2",{id:"upstream"},"@upstream"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"upstream")," directive allows you to control various aspects of the upstream server connection. This includes settings like connection timeouts, keep-alive intervals, and more. If not specified, default values are used."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},"schema @upstream(...[UpstreamSetting]...){\n    query: Query\n    mutation: Mutation\n}\n")),(0,i.kt)("p",null,"The various ",(0,i.kt)("inlineCode",{parentName:"p"},"UpstreamSetting")," options and their details are explained below."),(0,i.kt)("h3",{id:"poolidletimeout"},"poolIdleTimeout"),(0,i.kt)("p",null,"The time in seconds that the connection pool will wait before closing idle connections."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},'schema @upstream(poolIdleTimeout: 60, baseURL: "http://jsonplaceholder.typicode.com") {\n  query: Query\n  mutation: Mutation\n}\n')),(0,i.kt)("h3",{id:"poolmaxidleperhost"},"poolMaxIdlePerHost"),(0,i.kt)("p",null,"The maximum number of idle connections that will be maintained per host."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},'schema @upstream(poolMaxIdlePerHost: 60, baseURL: "http://jsonplaceholder.typicode.com") {\n  query: Query\n  mutation: Mutation\n}\n')),(0,i.kt)("h3",{id:"keepaliveinterval"},"keepAliveInterval"),(0,i.kt)("p",null,"The time in seconds between each keep-alive message sent to maintain the connection."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},'schema @upstream(keepAliveInterval: 60, baseURL: "http://jsonplaceholder.typicode.com") {\n  query: Query\n  mutation: Mutation\n}\n')),(0,i.kt)("h3",{id:"keepalivetimeout"},"keepAliveTimeout"),(0,i.kt)("p",null,"The time in seconds that the connection will wait for a keep-alive message before closing."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},'schema @upstream(keepAliveTimeout: 60, baseURL: "http://jsonplaceholder.typicode.com") {\n  query: Query\n  mutation: Mutation\n}\n')),(0,i.kt)("h3",{id:"keepalivewhileidle"},"keepAliveWhileIdle"),(0,i.kt)("p",null,"A boolean value that determines whether keep-alive messages should be sent while the connection is idle."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},'schema @upstream(keepAliveWhileIdle: false, baseURL: "http://jsonplaceholder.typicode.com") {\n  query: Query\n  mutation: Mutation\n}\n')),(0,i.kt)("h3",{id:"proxy"},"proxy"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"proxy")," setting defines an intermediary server through which the upstream requests will be routed before reaching their intended endpoint. By specifying a proxy URL, you introduce an additional layer, enabling custom routing and security policies."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},'schema @upstream(proxy: {url: "http://localhost:3000"}, baseURL: "http://jsonplaceholder.typicode.com") {\n  query: Query\n  mutation: Mutation\n}\n')),(0,i.kt)("p",null,"In the provided example, we've set the proxy's ",(0,i.kt)("inlineCode",{parentName:"p"},"url"),' to "http://localhost:3000". This configuration ensures that all requests aimed at the designated ',(0,i.kt)("inlineCode",{parentName:"p"},"baseURL")," are first channeled through this proxy. To illustrate, if the ",(0,i.kt)("inlineCode",{parentName:"p"},"baseURL"),' is "',(0,i.kt)("a",{parentName:"p",href:"http://jsonplaceholder.typicode.com%22"},'http://jsonplaceholder.typicode.com"'),', any request targeting it would be initially sent to "http://localhost:3000" before being redirected to its final destination.'),(0,i.kt)("h3",{id:"connecttimeout"},"connectTimeout"),(0,i.kt)("p",null,"The time in seconds that the connection will wait for a response before timing out."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},'schema @upstream(connectTimeout: 60, baseURL: "http://jsonplaceholder.typicode.com") {\n  query: Query\n  mutation: Mutation\n}\n')),(0,i.kt)("h3",{id:"timeout"},"timeout"),(0,i.kt)("p",null,"The maximum time in seconds that the connection will wait for a response."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},'schema @upstream(timeout: 60, baseURL: "http://jsonplaceholder.typicode.com") {\n  query: Query\n  mutation: Mutation\n}\n')),(0,i.kt)("h3",{id:"tcpkeepalive"},"tcpKeepAlive"),(0,i.kt)("p",null,"The time in seconds between each TCP keep-alive message sent to maintain the connection."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},'schema @upstream(tcpKeepAlive: 60, baseURL: "http://jsonplaceholder.typicode.com") {\n  query: Query\n  mutation: Mutation\n}\n')),(0,i.kt)("h3",{id:"useragent"},"userAgent"),(0,i.kt)("p",null,"The User-Agent header value to be used in HTTP requests."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},'schema @upstream(userAgent: "Tailcall/1.0", baseURL: "http://jsonplaceholder.typicode.com") {\n  query: Query\n  mutation: Mutation\n}\n')),(0,i.kt)("h3",{id:"allowedheaders"},"allowedHeaders"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"allowedHeaders")," configuration specifies which HTTP headers are permitted to be forwarded to upstream services when making requests.\nIf ",(0,i.kt)("inlineCode",{parentName:"p"},"allowedHeaders")," isn't specified, no incoming headers will be forwarded to the upstream services, which can provide an added layer of security but might restrict essential data flow."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},'schema @upstream(allowedHeaders: ["Authorization", "X-Api-Key"]) {\n  query: Query\n  mutation: Mutation\n}\n')),(0,i.kt)("p",null,"In the example above, the ",(0,i.kt)("inlineCode",{parentName:"p"},"allowedHeaders")," is set to allow only ",(0,i.kt)("inlineCode",{parentName:"p"},"Authorization")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"X-Api-Key")," headers. This means that requests containing these headers will forward them to upstream services, while all others will be ignored. It ensures that only expected headers are communicated to dependent services, emphasizing security and consistency."),(0,i.kt)("h3",{id:"baseurl"},"baseURL"),(0,i.kt)("p",null,"This refers to the default base URL for your APIs. If it's not explicitly mentioned in the ",(0,i.kt)("inlineCode",{parentName:"p"},"@upstream")," operator, then each ",(0,i.kt)("a",{parentName:"p",href:"#http"},"@http")," operator must specify its own ",(0,i.kt)("inlineCode",{parentName:"p"},"baseURL"),". If neither ",(0,i.kt)("inlineCode",{parentName:"p"},"@upstream")," nor ",(0,i.kt)("a",{parentName:"p",href:"#http"},"@http")," provides a ",(0,i.kt)("inlineCode",{parentName:"p"},"baseURL"),", it results in a compilation error."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},'schema @upstream(baseURL: "http://jsonplaceholder.typicode.com") {\n  query: Query\n  mutation: Mutation\n}\n')),(0,i.kt)("p",null,"In this representation, the ",(0,i.kt)("inlineCode",{parentName:"p"},"baseURL")," is set as ",(0,i.kt)("inlineCode",{parentName:"p"},"http://jsonplaceholder.typicode.com"),". Thus, all API calls made by ",(0,i.kt)("inlineCode",{parentName:"p"},"@http")," will prepend this URL to their respective paths."),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"Ensure that your base URL remains free from specific path segments."),(0,i.kt)("ul",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"GOOD:")," ",(0,i.kt)("inlineCode",{parentName:"li"},"@upstream(baseURL: http://jsonplaceholder.typicode.com)")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"BAD:")," ",(0,i.kt)("inlineCode",{parentName:"li"},"@upstream(baseURL: http://jsonplaceholder.typicode.com/api)")))),(0,i.kt)("h3",{id:"enablehttpcache"},"enableHttpCache"),(0,i.kt)("p",null,"When activated, directs Tailcall to utilize HTTP caching mechanisms. These mechanisms, in accordance with the ",(0,i.kt)("a",{parentName:"p",href:"https://tools.ietf.org/html/rfc7234"},"HTTP Caching RFC"),", are designed to improve performance by reducing unnecessary data fetches. If left unspecified, this feature defaults to ",(0,i.kt)("inlineCode",{parentName:"p"},"false"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},"schema @upstream(enableHttpCache: false) {\n  query: Query\n  mutation: Mutation\n}\n")),(0,i.kt)("h3",{id:"enablebatchrequests"},"enableBatchRequests"),(0,i.kt)("p",null,"Batching in GraphQL combines multiple requests into one, reducing server round trips."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},"schema @server(\n  port: 8000\n  enableBatchRequests: true\n)\n")),(0,i.kt)("h4",{id:"trade-offs"},"Trade-offs"),(0,i.kt)("p",null,"Batching can improve performance but may introduce latency if one request in the batch takes longer. It also makes network traffic debugging harder."),(0,i.kt)("h4",{id:"tips"},"Tips"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Only use batching if necessary and other optimization techniques don't resolve performance issues."),(0,i.kt)("li",{parentName:"ul"},"Use batching judiciously and monitor its impact."),(0,i.kt)("li",{parentName:"ul"},"Be aware that batching can complicate debugging")),(0,i.kt)("h3",{id:"batch"},"batch"),(0,i.kt)("p",null,"An object that specifies the batch settings, including ",(0,i.kt)("inlineCode",{parentName:"p"},"maxSize")," (the maximum size of the batch), ",(0,i.kt)("inlineCode",{parentName:"p"},"delay")," (the delay in milliseconds between each batch), and ",(0,i.kt)("inlineCode",{parentName:"p"},"headers")," (an array of HTTP headers to be included in the batch)."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},'schema @upstream(batch: {maxSize: 1000, delay: 10, headers: ["X-Server", "Authorization"]}) {\n  query: Query\n  mutation: Mutation\n}\n')),(0,i.kt)("h2",{id:"http"},"@http"),(0,i.kt)("p",null,"This ",(0,i.kt)("strong",{parentName:"p"},"@http")," operator serves as an indication of a field or node that is underpinned by a REST API. For Example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},'type Query {\n  user(id: ID!): User @http(path: "/users")\n}\n')),(0,i.kt)("p",null,"In this example, the ",(0,i.kt)("inlineCode",{parentName:"p"},"@http")," operator is added to the ",(0,i.kt)("inlineCode",{parentName:"p"},"user")," field of the ",(0,i.kt)("inlineCode",{parentName:"p"},"Query")," type. This means that the ",(0,i.kt)("inlineCode",{parentName:"p"},"user")," field is underpinned by a REST API. The ",(0,i.kt)("a",{parentName:"p",href:"#path"},"path")," argument is used to specify the path of the REST API. In this case, the path is ",(0,i.kt)("inlineCode",{parentName:"p"},"/users"),". This means that the GraphQL server will make a GET request to ",(0,i.kt)("inlineCode",{parentName:"p"},"https://jsonplaceholder.typicode.com/users")," when the ",(0,i.kt)("inlineCode",{parentName:"p"},"user")," field is queried."),(0,i.kt)("h3",{id:"baseurl-1"},"baseURL"),(0,i.kt)("p",null,"This refers to the base URL of the API. If not specified, the default base URL is the one specified in the ",(0,i.kt)("a",{parentName:"p",href:"#server"},"@server")," operator."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},'type Query {\n  user(id: ID!): User @http(path: "/users", baseURL: "https://jsonplaceholder.typicode.com")\n}\n')),(0,i.kt)("h3",{id:"path"},"path"),(0,i.kt)("p",null,"This refers to the API endpoint you're going to call. For instance ",(0,i.kt)("a",{parentName:"p",href:"https://jsonplaceholder.typicode.com/users%60"},"https://jsonplaceholder.typicode.com/users`"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},'type Query {\n  user(id: ID!): User @http(path: "/users")\n}\n')),(0,i.kt)("p",null,"If your API endpoint contains dynamic segments, you can use Mustache templates to substitute variables. For example, to fetch a specific user, the path can be written as ",(0,i.kt)("inlineCode",{parentName:"p"},"/users/{{args.id}}"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},'type Query {\n  user(id: ID!): User @http(path: "/users/{{args.id}}")\n}\n')),(0,i.kt)("h3",{id:"method"},"method"),(0,i.kt)("p",null,"This refers to the HTTP method of the API call. Commonly used methods include GET, POST, PUT, DELETE, etc. If not specified, the default method is GET. For example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},'type Mutation {\n  createUser(input: UserInput!): User @http(method: "POST", path: "/users")\n}\n')),(0,i.kt)("h3",{id:"query"},"query"),(0,i.kt)("p",null,"This represents the query parameters of your API call. You can pass it as a static object or use Mustache template for dynamic parameters. These parameters will be added to the URL. For example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},'type Query {\n  userPosts(id: ID!): [Post] @http(path: "/posts", query: [{key: "userId", value: "{{args.id}}"}])\n}\n')),(0,i.kt)("h3",{id:"body"},"body"),(0,i.kt)("p",null,"The body of the API call. It's used for methods like POST or PUT that send data to the server. You can pass it as a static object or use a Mustache template to substitute variables from the GraphQL variables. For example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},'type Mutation {\n  createUser(input: UserInput!): User @http(method: "POST", path: "/users", body: "{{args.input}}")\n}\n')),(0,i.kt)("p",null,"In the example above, the ",(0,i.kt)("inlineCode",{parentName:"p"},"createUser")," mutation sends a POST request to ",(0,i.kt)("inlineCode",{parentName:"p"},"/users"),", with the input object converted to JSON and included in the request body."),(0,i.kt)("h3",{id:"headers"},"headers"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"headers")," parameter allows you to customize the headers of the HTTP request made by the ",(0,i.kt)("inlineCode",{parentName:"p"},"@http")," operator. It is used by specifying a key-value map of header names and their values."),(0,i.kt)("p",null,"For instance:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},'type Mutation {\n  createUser(input: UserInput!): User @http(path: "/users", headers: [{key: "X-Server", value: "Tailcall"}])\n}\n')),(0,i.kt)("p",null,"In this example, a request to ",(0,i.kt)("inlineCode",{parentName:"p"},"/users")," will include an additional HTTP header ",(0,i.kt)("inlineCode",{parentName:"p"},"X-Server")," with the value ",(0,i.kt)("inlineCode",{parentName:"p"},"Tailcall"),"."),(0,i.kt)("p",null,"You can make use of mustache templates to provide dynamic values for headers, derived from the arguments or ",(0,i.kt)("a",{parentName:"p",href:"/docs/guides/context"},"context")," provided in the request. For example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},'type Mutation {\n  users(name: String): User\n    @http(path: "/users", headers: [{key: "X-Server", value: "Tailcall"}, {key: "User-Name", value: "{{args.name}}"}])\n}\n')),(0,i.kt)("p",null,"In this scenario, the ",(0,i.kt)("inlineCode",{parentName:"p"},"User-Name")," header's value will dynamically adjust according to the ",(0,i.kt)("inlineCode",{parentName:"p"},"name")," argument passed in the request."),(0,i.kt)("h3",{id:"groupby"},"groupBy"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"groupBy")," parameter groups multiple data requests into a single call. For more details please refer out ",(0,i.kt)("a",{parentName:"p",href:"/docs/guides/n+1#solving-using-batching"},"n + 1 guide"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},'type Post {\n  id: Int!\n  name: String!\n  user: User @http(path: "/users", query: [{key: "id", value: "{{value.userId}}"}], groupBy: ["id"])\n}\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},'query: {key: "id", value: "{{value.userId}}"}]'),": Here, TailCall CLI is instructed to generate a URL where the user id aligns with the ",(0,i.kt)("inlineCode",{parentName:"li"},"userId")," from the parent ",(0,i.kt)("inlineCode",{parentName:"li"},"Post"),". For a batch of posts, the CLI compiles a single URL, such as ",(0,i.kt)("inlineCode",{parentName:"li"},"/users?id=1&id=2&id=3...id=10"),", consolidating multiple requests into one.")),(0,i.kt)("h2",{id:"modify"},"@modify"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"@modify")," operator in GraphQL provides the flexibility to alter the attributes of a field or a node within your GraphQL schema. Here's how you can use this operator:"),(0,i.kt)("h3",{id:"name"},"name"),(0,i.kt)("p",null,"You can rename a field or a node in your GraphQL schema using the ",(0,i.kt)("inlineCode",{parentName:"p"},"name")," argument in the ",(0,i.kt)("inlineCode",{parentName:"p"},"@modify")," operator. This can be helpful when the field name in your underlying data source doesn't match the desired field name in your schema. For instance:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},'type User {\n  id: Int! @modify(name: "userId")\n}\n')),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},'@modify(name: "userId")')," tells GraphQL that although the field is referred to as ",(0,i.kt)("inlineCode",{parentName:"p"},"id"),"in the underlying data source, it should be presented as ",(0,i.kt)("inlineCode",{parentName:"p"},"userId")," in your schema."),(0,i.kt)("h3",{id:"omit"},"omit"),(0,i.kt)("p",null,"You can exclude a field or a node from your GraphQL schema using the ",(0,i.kt)("inlineCode",{parentName:"p"},"omit")," argument in the ",(0,i.kt)("inlineCode",{parentName:"p"},"@modify")," operator. This can be useful if you want to keep certain data hidden from the client. For instance:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},"type User {\n  id: Int! @modify(omit: true)\n}\n")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"@modify(omit: true)")," tells GraphQL that the ",(0,i.kt)("inlineCode",{parentName:"p"},"id")," field should not be included in the schema, thus it won't be accessible to the client."),(0,i.kt)("h2",{id:"addfield"},"@addField"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"@addField")," operator simplifies data structures and queries by adding a field that ",(0,i.kt)("em",{parentName:"p"},"inlines")," or flattens a nested field or node within your schema. It works by modifying the schema and the data transformation process, simplifiying how nested data is accessed and presented."),(0,i.kt)("p",null,"For instance, consider a schema:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},'schema {\n  query: Query\n}\n\ntype User @addField(name: "street", path: ["address", "street"]) {\n  id: Int!\n  name: String!\n  username: String!\n  email: String!\n  phone: String\n  website: String\n  address: Address @modify(omit: true)\n}\n\ntype Address {\n  street: String!\n  city: String!\n  state: String!\n}\n\ntype Query {\n  user(id: Int!): User @http(path: "/users/{{args.id}}")\n}\n')),(0,i.kt)("p",null,"Suppose we are only interested in the ",(0,i.kt)("inlineCode",{parentName:"p"},"street")," field in ",(0,i.kt)("inlineCode",{parentName:"p"},"Address"),"."),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"@addField")," operator above, applied to the ",(0,i.kt)("inlineCode",{parentName:"p"},"User")," type in this case, creates a field called ",(0,i.kt)("inlineCode",{parentName:"p"},"street")," in the ",(0,i.kt)("inlineCode",{parentName:"p"},"User")," type. It includes a ",(0,i.kt)("inlineCode",{parentName:"p"},"path")," argument, indicating the chain of fields to be traversed from a declared field (",(0,i.kt)("inlineCode",{parentName:"p"},"address")," in this case), to the field within Address to be added. We can also add a ",(0,i.kt)("inlineCode",{parentName:"p"},"@modify(omit: true)")," to omit the ",(0,i.kt)("inlineCode",{parentName:"p"},"address")," field from the schema, since we have already made its ",(0,i.kt)("inlineCode",{parentName:"p"},"street")," field available on the ",(0,i.kt)("inlineCode",{parentName:"p"},"User")," type."),(0,i.kt)("p",null,"Post application, the schema becomes:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},"schema {\n  query: Query\n}\n\ntype User {\n  id: Int!\n  name: String!\n  username: String!\n  email: String!\n  phone: String\n  website: String\n  street: String\n}\n\ntype Query {\n  user(id: Int): Post!\n}\n")),(0,i.kt)("p",null,"In the above example, since we added a ",(0,i.kt)("inlineCode",{parentName:"p"},"@modify(omit: true)")," on the ",(0,i.kt)("inlineCode",{parentName:"p"},"address")," field, the ",(0,i.kt)("inlineCode",{parentName:"p"},"Address")," type is eliminated from the schema."),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"@addField")," operator also take cares of nullablity of the fields. If any of the fields in the path is nullable, the resulting type will be nullable."),(0,i.kt)("p",null,"Additionally, ",(0,i.kt)("inlineCode",{parentName:"p"},"@addField")," supports indexing, meaning you can specify the array index to be inlined. If a field ",(0,i.kt)("inlineCode",{parentName:"p"},"posts")," is of type ",(0,i.kt)("inlineCode",{parentName:"p"},"[Post]"),", and you want to, for example, get the title of the first post, you can specify the path as ","[",(0,i.kt)("inlineCode",{parentName:"p"},'"posts"'),",",(0,i.kt)("inlineCode",{parentName:"p"},'"0"'),",",(0,i.kt)("inlineCode",{parentName:"p"},'"title"'),"]","."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql",metastring:"showLineNumbers",showLineNumbers:!0},'type User @addField(name: "firstPostTitle", path: ["posts", "0", "title"]) {\n  id: Int!\n  name: String!\n  username: String!\n  email: String!\n  phone: String\n  website: String\n  posts: Post @http(path: "/users/{{value.id}}/posts")\n}\n\ntype Post {\n  id: Int!\n  userId: Int!\n  title: String!\n  body: String!\n}\n')),(0,i.kt)("p",null,"In conclusion, the ",(0,i.kt)("inlineCode",{parentName:"p"},"@addField")," operator helps tidy up your schema and streamline data fetching by reducing query depth, promoting better performance and simplicity."),(0,i.kt)("h2",{id:"const"},"@const"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"@const")," operators allows us to embed a constant response for the schema. For eg:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-graphql"},'schema {\n  query: Query\n}\n\ntype Query {\n  user: User @const(data: {name: "John", age: 12})\n}\n\ntype User {\n  name: String\n  age: Int\n}\n')),(0,i.kt)("p",null,"The const operator will also validate the provided value at compile time to make sure that it matches the of the field. If the schema of the provided value doesn't match the type of the field, a descriptive error message is show on the console."))}h.isMDXComponent=!0}}]);